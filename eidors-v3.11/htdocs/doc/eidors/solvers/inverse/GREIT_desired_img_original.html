<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of GREIT_desired_img_original</title>
  <meta name="keywords" content="GREIT_desired_img_original">
  <meta name="description" content="GREIT_DESIRED_IMG_ORIGINAL The original desired solution for GREIT">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="../../index.html">eidors</a> &gt; <a href="../index.html">solvers</a> &gt; <a href="index.html">inverse</a> &gt; GREIT_desired_img_original.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for eidors/solvers/inverse&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>GREIT_desired_img_original
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>GREIT_DESIRED_IMG_ORIGINAL The original desired solution for GREIT</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function PSF= GREIT_desired_img_original(xyc, radius, opt) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">GREIT_DESIRED_IMG_ORIGINAL The original desired solution for GREIT
 PSF= GREIT_desired_img_original(xyc, radius, opt)
   xyc     - array of point centers [2xNpoints]
   radius  - the radius of the target on the desired image as a fraction
             of the model radius (half the larger dimension in xy)
   opt     - a struct with these mandatory fields:
      .rec_model   a 2D model as generated by MK_GRID_MODEL, with some
                   restrictions, see below. 

 The supplied opt.rec_model is only used to figure out the requested image
 size in pixels, and the coordinates of the model in space. If pixels are 
 removed from the model, a boolean opt.rec_model.inside must be specified
 indicating the removed pixels with false, as done by MK_PIXEL_SLICE.
 Nodes must not be removed. Only equal-size pixels are supported.

 NOTE that the amount of blur provided by this function decreases as the
 resolution of the image increases. 

 As of 2015-03-29, the default desired image function used by
 MK_GRID_MODEL is MK_DESIRED_IMAGE_SIGMOID.

 See also: <a href="calc_GREIT_RM.html" class="code" title="function [RM, PJt, M] = calc_GREIT_RM(vh,vi, xyc, radius, weight, options)">CALC_GREIT_RM</a>, MK_GREIT_MODEL, MK_PIXEL_SLICE,
           <a href="GREIT_desired_img_sigmoid.html" class="code" title="function PSF = GREIT_desired_img_sigmoid(xyz,radius, opt)">GREIT_DESIRED_IMG_SIGMOID</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../eidors/tools/eidors_cache.html" class="code" title="function varargout=eidors_cache( command, varargin )">eidors_cache</a>	EIDORS_CACHE Control eidors caching</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="GREIT_desired_img_FEMmesh.html" class="code" title="function PSF= GREIT_desired_img_FEMmesh(xyc, radius, opt)">GREIT_desired_img_FEMmesh</a>	GREIT_DESIRED_IMG_FEMmesh  GREIT onto a FEM mesh</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function PSF = desired_soln(xyc,radius,opt)</a></li><li><a href="#_sub2" class="code">function opt = parse_opt(mdl)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function PSF= GREIT_desired_img_original(xyc, radius, opt)</a>
0002 <span class="comment">%GREIT_DESIRED_IMG_ORIGINAL The original desired solution for GREIT</span>
0003 <span class="comment">% PSF= GREIT_desired_img_original(xyc, radius, opt)</span>
0004 <span class="comment">%   xyc     - array of point centers [2xNpoints]</span>
0005 <span class="comment">%   radius  - the radius of the target on the desired image as a fraction</span>
0006 <span class="comment">%             of the model radius (half the larger dimension in xy)</span>
0007 <span class="comment">%   opt     - a struct with these mandatory fields:</span>
0008 <span class="comment">%      .rec_model   a 2D model as generated by MK_GRID_MODEL, with some</span>
0009 <span class="comment">%                   restrictions, see below.</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% The supplied opt.rec_model is only used to figure out the requested image</span>
0012 <span class="comment">% size in pixels, and the coordinates of the model in space. If pixels are</span>
0013 <span class="comment">% removed from the model, a boolean opt.rec_model.inside must be specified</span>
0014 <span class="comment">% indicating the removed pixels with false, as done by MK_PIXEL_SLICE.</span>
0015 <span class="comment">% Nodes must not be removed. Only equal-size pixels are supported.</span>
0016 <span class="comment">%</span>
0017 <span class="comment">% NOTE that the amount of blur provided by this function decreases as the</span>
0018 <span class="comment">% resolution of the image increases.</span>
0019 <span class="comment">%</span>
0020 <span class="comment">% As of 2015-03-29, the default desired image function used by</span>
0021 <span class="comment">% MK_GRID_MODEL is MK_DESIRED_IMAGE_SIGMOID.</span>
0022 <span class="comment">%</span>
0023 <span class="comment">% See also: CALC_GREIT_RM, MK_GREIT_MODEL, MK_PIXEL_SLICE,</span>
0024 <span class="comment">%           GREIT_DESIRED_IMG_SIGMOID</span>
0025 
0026 <span class="comment">% (C) 2009-2015 Andy Adler and Bartlomiej Grychtol.</span>
0027 <span class="comment">% License: GPL v2 or v3</span>
0028 <span class="comment">% $Id: GREIT_desired_img_original.m 4986 2015-05-11 20:09:28Z aadler $</span>
0029 
0030    opt = <a href="#_sub2" class="code" title="subfunction opt = parse_opt(mdl)">parse_opt</a>(opt.rec_model);
0031    
0032    copt.fstr = <span class="string">'GREIT_desired_img_original'</span>;
0033    copt.cache_obj = {xyc, radius, opt};
0034    PSF = <a href="../../../eidors/tools/eidors_cache.html" class="code" title="function varargout=eidors_cache( command, varargin )">eidors_cache</a>(@<a href="#_sub1" class="code" title="subfunction PSF = desired_soln(xyc,radius,opt)">desired_soln</a>,{xyc, radius, opt},copt);
0035 <span class="keyword">end</span>
0036 
0037 <a name="_sub1" href="#_subfunctions" class="code">function PSF = desired_soln(xyc,radius,opt)</a>
0038    
0039    xsz = opt.imgsz(1); ysz = opt.imgsz(2);
0040    sz= xsz * ysz;
0041    xmin = opt.meshsz(1); xmax = opt.meshsz(2);
0042    ymin = opt.meshsz(3); ymax = opt.meshsz(4);
0043    <span class="comment">% scale radius to half the greater dimension</span>
0044    radius = radius * 0.5 * max(xmax-xmin, ymax-ymin);
0045    [x,y]= ndgrid(linspace(xmin,xmax,xsz), linspace(ymin,ymax,ysz));
0046    x_spc = (xmax-xmin)/(xsz-1) * 0.5;
0047    y_spc = (ymax-ymin)/(ysz-1) * 0.5;
0048    PSF = zeros(sz,size(xyc,2));
0049    <span class="keyword">for</span> i=1:size(xyc,2);
0050       <span class="keyword">for</span> dx = linspace(-x_spc, x_spc, 5)
0051          <span class="keyword">for</span> dy = linspace(-y_spc, y_spc, 5)
0052             PSF(:,i) = PSF(:,i) +  1/25*( <span class="keyword">...</span>
0053                (dx+x(:)-xyc(1,i)).^2 + (dy+y(:)-xyc(2,i)).^2 <span class="keyword">...</span>
0054                         &lt; radius^2 );
0055          <span class="keyword">end</span>
0056       <span class="keyword">end</span>
0057 <span class="comment">%     PSF(:,i) = PSF(:,i)/sum(PSF(:,i));</span>
0058    <span class="keyword">end</span>
0059    <span class="keyword">if</span> ~isempty(opt.inside)
0060        PSF = PSF(opt.inside,:);
0061    <span class="keyword">end</span>
0062    
0063 <span class="keyword">end</span>
0064 
0065 <a name="_sub2" href="#_subfunctions" class="code">function opt = parse_opt(mdl)</a>
0066     opt.meshsz = [];    
0067     <span class="keyword">for</span> i = 1:2
0068         opt.meshsz = [opt.meshsz min(mdl.nodes(:,i)) max(mdl.nodes(:,i))];
0069     <span class="keyword">end</span>
0070     opt.imgsz(1) = numel(unique(mdl.nodes(:,1))) - 1;
0071     opt.imgsz(2) = numel(unique(mdl.nodes(:,2))) - 1;
0072 <span class="comment">%     opt.inside = [];</span>
0073 <span class="comment">%     try</span>
0074         opt.inside = mdl.inside;
0075 <span class="comment">%     end</span>
0076 <span class="keyword">end</span>
0077</pre></div>
<hr><address>Generated on Fri 30-Dec-2022 20:46:51 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>